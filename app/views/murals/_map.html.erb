<!DOCTYPE html>
<html>
<head>
    <style type="text/css">
        #map_canvas {width:100%; height:400px;}
    </style>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?key=AIzaSyDqnbDDZdGNHuoFZk6LM3Jwq2JE8iVv7OA"></script>

    <script type="text/javascript">
        var map, geocoder;
        var markersArray = [];

        function initMap()
        {
            var latlng = new google.maps.LatLng(54.602724, -5.929291);
            var myOptions = {
                zoom: 13,
                center: latlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

            // add a click event handler to the map object
            google.maps.event.addListener(map, "click", function(event)
            {
                placeMarker(event.latLng);
                document.getElementById("lat").value = event.latLng.lat();
                document.getElementById("long").value = event.latLng.lng();
                document.getElementById("address").value = ;

            }); 
        }

        function placeMarker(location) {
            // first remove all markers if there are any
            deleteOverlays();
            var marker = new google.maps.Marker({
                position: location, 
                map: map
            });
            // add marker in markers array
            markersArray.push(marker); 
        }

        // Deletes all markers in the array by removing references to them
        function deleteOverlays() {
            if (markersArray) {
                for (i in markersArray) {
                    markersArray[i].setMap(null);
                }
                markersArray.length = 0;
            }
        }

        function getAddress(geocoder, latlng, address){
        geocoder.geocode({'location': latlng}, function(results, status) {
          if (status === 'OK') {
            if (results[0]) {
              //address[i] = results[0].formatted_address;
              //alert(i + ": " + address[i]);
              address1 = results[0].formatted_address;
              alert(address1);
              return address1;

            } else {
              window.alert('No results found');
            }
          } else {
            window.alert('Geocoder failed due to: ' + status);
          }
        });
        
        
      }
    </script>
</head>

<body onload="initMap()">
    <div id="map_canvas"></div>    
</body>
</html>